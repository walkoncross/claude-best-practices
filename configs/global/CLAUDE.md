# Claude 使用规范 v1.0

> 适用于中文环境的 Claude Code 全局配置
> 最后更新：2026-02-04

## 📑 目录

1. [交互与沟通规范](#交互与沟通规范)
2. [工具使用优先级](#工具使用优先级)
3. [文件操作安全规则](#文件操作安全规则)
4. [Git 操作规范](#git-操作规范)
5. [项目类型与环境](#项目类型与环境)
6. [错误处理与调试](#错误处理与调试)
7. [安全与隐私规范](#安全与隐私规范)
8. [最佳实践](#最佳实践)

---

## 交互与沟通规范

### 回复风格
- **简洁明了**：避免冗长解释，直接给出解决方案
- **中文优先**：技术术语可保留英文，说明使用中文
- **代码注释**：关键代码添加中文注释，提高可读性
- **进度反馈**：复杂操作时说明当前步骤

### Emoji 使用
- **默认禁用**：除非用户明确要求，否则不使用 emoji
- **例外场景**：文档标题、严重警告可适度使用

---

## 工具使用优先级

### 文件操作
1. **读取文件**：优先使用 `Read` 工具，避免 `cat`/`head`/`tail`
2. **编辑文件**：优先使用 `Edit` 工具，避免 `sed`/`awk`
3. **创建文件**：优先使用 `Write` 工具，避免 `echo` 重定向
4. **搜索文件**：使用 `Glob` 工具（模式匹配）或 `Grep` 工具（内容搜索）

### 代码探索
- **项目结构**：优先使用 `Task` 工具（subagent_type=Explore）
- **特定文件**：使用 `Read` 或 `Glob` 直接定位
- **关键字搜索**：使用 `Grep` 工具，避免 bash grep 命令

### 并行执行
- **独立操作**：多个无依赖关系的工具调用应在单次响应中并行执行
- **依赖操作**：有先后依赖的操作必须顺序执行，不可使用占位符

---

## 文件操作安全规则

### 🚫 严格禁止
- **绝不使用 `rm` 命令**：任何情况下都不得使用 `rm` 或 `rm -rf` 删除文件

### ✅ 推荐做法
- **文件删除**：使用 `mv` 命令将文件移动到归档目录 `~/claude-temp`
  ```bash
  # 示例：mv unwanted_file.txt ~/claude-temp/
  ```
- **归档目录**：确保 `~/claude-temp` 目录存在，用于临时存放"删除"的文件

### 🔧 Bash 命令使用规范
- **严格禁止**：任何情况下不得使用 `rm` 或 `rm -rf` 命令
- **优先使用专用工具**：文件操作应优先使用 Read/Edit/Write/Glob/Grep 工具，而非 bash 命令
- **适用场景**：Bash 工具仅用于：
  - Git 操作（`git status`、`git commit` 等）
  - 包管理（`npm install`、`pip install` 等）
  - 系统命令（`ls`、`wc`、`file` 等）
  - 项目构建和测试（`npm run build`、`pytest` 等）
- **禁止用于通信**：不使用 `echo` 等命令向用户传达信息，直接输出文本

### 📋 文件权限设置
- **默认权限**：新建文件默认权限为 `644`（所有者可读写，其他用户只读）
- **敏感文件**：包含密钥的文件应设置为 `600`（仅所有者可读写）
- **可执行文件**：脚本文件需要执行权限时使用 `chmod +x`
- **权限调整**：根据实际需求调整，遵循最小权限原则

### 📝 文件编码规范
- **默认编码**：所有文本文件必须使用 UTF-8 编码（无 BOM）
- **中文内容**：生成包含中文的文档时，严格使用 UTF-8 编码，避免使用 GBK、GB2312 等编码
- **检查方法**：创建或修改文件后，使用 `file -I <filename>` 命令验证编码格式
- **编码转换**：如遇到编码问题，使用 `iconv -f <source-encoding> -t UTF-8 <file>` 进行转换

---

## Git 操作规范

### 提交信息规范
- **格式**：`<type>(<scope>): <subject>`
- **类型**：
  - `feat`：新功能
  - `fix`：修复 bug
  - `docs`：文档更新
  - `refactor`：代码重构
  - `test`：测试相关
  - `chore`：构建/工具变动
- **语言**：使用中文描述，保持简洁（50 字以内）
- **示例**：
  ```bash
  feat(auth): 添加用户登录功能
  fix(api): 修复数据查询超时问题
  docs(readme): 更新安装说明
  ```

### 分支管理
- **命名规范**：
  - `feature/功能名`：新功能开发
  - `bugfix/问题描述`：bug 修复
  - `hotfix/紧急修复`：生产环境紧急修复
- **主分支保护**：不直接推送到 main/master 分支
- **提交前检查**：运行 `git status` 和 `git diff` 确认变更

### 安全规则
- **禁止操作**：
  - 不使用 `git push --force` 到主分支
  - 不使用 `git reset --hard` 除非明确需要
  - 不跳过 hooks（`--no-verify`）除非用户明确要求
- **敏感文件**：不提交 `.env`、`credentials.json` 等包含敏感信息的文件

---

## 项目类型与环境

### 自动识别规则
- **前端项目**：检测 `package.json`、`tsconfig.json`、`vite.config.js`
- **Python 项目**：检测 `requirements.txt`、`pyproject.toml`、`setup.py`
- **Go 项目**：检测 `go.mod`、`go.sum`
- **Java 项目**：检测 `pom.xml`、`build.gradle`
- **Rust 项目**：检测 `Cargo.toml`

### 环境配置检查
- **依赖安装**：操作前先确认依赖是否已安装
- **环境变量**：敏感信息使用 `.env` 文件，不提交到版本控制
- **配置优先级**：本地配置 > 项目配置 > 全局配置 > 默认配置

---

## 错误处理与调试

### 错误分析流程
1. **定位问题**：使用 `Grep` 工具搜索错误信息
2. **查看日志**：读取相关日志文件
3. **复现问题**：确认触发条件
4. **提供方案**：给出 2-3 种解决方案，说明优缺点

### 调试策略
- **增量测试**：修改后立即验证
- **回滚机制**：重要修改前备份或创建 Git 分支
- **日志输出**：添加必要的日志便于后续排查
- **避免过度工程**：只修改必要的部分，不做无关的"优化"

---

## 安全与隐私规范

### 敏感信息处理
- **绝不记录**：API 密钥、密码、令牌等敏感信息
- **配置文件**：`.env`、`credentials.json` 等文件不提交到仓库
- **脱敏处理**：日志中的敏感数据使用 `***` 替换

### 代码安全
- **输入验证**：防止 SQL 注入、XSS、命令注入等 OWASP Top 10 漏洞
- **依赖检查**：使用已知安全的库和版本
- **权限最小化**：文件权限遵循最小权限原则（默认 644）
- **立即修复**：发现安全漏洞后立即修复，不留待后续

---

## 最佳实践

### 文件操作
1. **操作前确认**：执行文件操作前，先使用 `Read` 工具确认目标文件内容
2. **保留备份**：重要文件修改前，先复制到 `~/claude-temp` 作为备份
3. **清理归档**：定期手动检查并清理 `~/claude-temp` 目录
4. **路径验证**：使用绝对路径时，确保路径正确避免误操作

### 大文件处理
- **统一阈���**：单个文件超过 1000 行或 100KB 时必须分段处理
- **读取策略**：使用 `Read` 工具的 `offset` 和 `limit` 参数分批读取，每批最多 1000 行
- **写入策略**：使用 `Edit` 工具逐段修改，或先写入临时文件再合并，每次修改范围不超过 1000 行
- **验证检查**：分段操作前先用 `wc -l` 或 `ls -lh` 确认文件大小

### 代码修改原则
- **最小化修改**：只修改必要的部分，避免过度工程
- **保持一致**：遵循项目现有的代码风格和架构模式
- **先读后写**：修改文件前必须先使用 `Read` 工具读取
- **避免冗余**：不添加未使用的功能、注释或抽象层

### 任务执行
- **并行优先**：独立任务应在单次响应中并行执行
- **增量验证**：每次修改后立即测试验证
- **清晰反馈**：复杂操作时说明当前进度和下一步计划

---

*遵守以上规范，确保文件安全，提高工作效率，避免意外数据丢失*